{% extends "layout.html" %}

{% block title %}Trang Chủ - Danh Sách Sách{% endblock %}

{% block content %}
    <h1>Danh Mục Sách Thư Viện</h1>

    {% if books %}
    <p>Đang hiển thị tổng cộng **{{ books|length }}** cuốn sách.</p>

    <div class="book-grid">
        {% for book in books %}
            <div class="book-card">

                {#hình ảnh sách trang chủ #}
                <img src="{{ book.image_url or url_for('static', filename='images/default_book.jpg') }}" 
                     alt="{{ book.title }}" 
                     class="book-card-img">
                
                <h5>{{ book.title }}</h5>
                <h6>Tác giả: {{ book.author }}</h6>
                
                <p> 
                    <span>Năm xuất bản: **{{ book.year }}**</span>
                    
                    <strong>Tình trạng:</strong> 
                    
                    {% if book.available > 0 %}
                        <span>Còn mượn ({{ book.available }})</span>
                    {% else %}
                        <span>Hết sách</span> 
                    {% endif %}
                </p>
                
                <a href="{{ url_for('book_detail', book_id=book.id) }}">Chi Tiết</a>
                
                {% if session.get('user') and session['user']['role'] == 'user' %}
                    {% if book.available > 0 %}
                        <a href="{{ url_for('add_to_cart', book_id=book.id) }}">Thêm vào Giỏ</a>
                    {% else %}
                        <button disabled>Hết Sách</button>
                    {% endif %}
                {% endif %}
                
            </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="empty-message">
        Không tìm thấy cuốn sách nào trong hệ thống.
    </div>
    {% endif %}

{% endblock %}